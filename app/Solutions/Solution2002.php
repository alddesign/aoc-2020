<?php
declare(strict_types = 1);
namespace Alddesign\EzMvc\Solutions;

use Alddesign\EzMvc\System\Helper;
use Exception;

class Solution2002 extends Solution
{
	public $ready = true;

	private const INPUT =
	[
		'Tile 3187:',
		'.........#',
		'....##...#',
		'##..#.#..#',
		'#.##....##',
		'..#.##...#',
		'##.#..#.#.',
		'#.##.....#',
		'####......',
		'...#..#..#',
		'.##..##.#.',
		'Tile 1223:',
		'###.#..###',
		'#......#.#',
		'........##',
		'..#.....##',
		'##.......#',
		'#........#',
		'#..#.#...#',
		'..#.##....',
		'####.....#',
		'.##..##..#',
		'Tile 1913:',
		'..#.......',
		'##........',
		'##.#.#..##',
		'#..#......',
		'###.#....#',
		'.....##.#.',
		'.......###',
		'.##......#',
		'#.....##..',
		'#.#.#.###.',
		'Tile 1301:',
		'#...#..#.#',
		'#..#...#..',
		'#........#',
		'.#..#....#',
		'.#.#.##.#.',
		'#....##.##',
		'#...#....#',
		'#.##....##',
		'.###....#.',
		'.#.#####..',
		'Tile 3943:',
		'..#.#.#..#',
		'.#..#....#',
		'#.....###.',
		'#..#...#..',
		'....#.##.#',
		'.#........',
		'#..#...#.#',
		'#..#.#..##',
		'....#...#.',
		'#.####....',
		'Tile 3023:',
		'#..#....##',
		'##..#.##.#',
		'#.##.#...#',
		'....##...#',
		'.##..##..#',
		'......#...',
		'##......##',
		'#..#..#...',
		'##.#.....#',
		'.#..#....#',
		'Tile 3299:',
		'#...#....#',
		'.####.#..#',
		'.........#',
		'.#.....#..',
		'#...#.##.#',
		'..#.#..#.#',
		'##.##....#',
		'#..#.#...#',
		'##........',
		'.#.#.#.###',
		'Tile 3677:',
		'..#.#..#.#',
		'#.#..#...#',
		'#..#.#...#',
		'#...#.##..',
		'#..#......',
		'#.#..#....',
		'#...#..#..',
		'#....##..#',
		'..#..#.#..',
		'#.####.#..',
		'Tile 2803:',
		'.#.#..####',
		'#.#.#....#',
		'#.......##',
		'..#..##.##',
		'#...#.....',
		'##.#.....#',
		'..#..#..##',
		'...#.#.#..',
		'#...#.###.',
		'####.##.##',
		'Tile 3343:',
		'###.##..##',
		'...#.#...#',
		'#....#..#.',
		'#...#....#',
		'..#.#.....',
		'.######.##',
		'#.###.####',
		'..##...##.',
		'#.##......',
		'...#..#.#.',
		'Tile 1987:',
		'.......##.',
		'.#.....#..',
		'#....###..',
		'###.##....',
		'.#...#...#',
		'#.#..###.#',
		'......#..#',
		'...##.....',
		'...##....#',
		'#...#####.',
		'Tile 1609:',
		'...#.##.##',
		'......#...',
		'..#..#.#.#',
		'...##.....',
		'###.####.#',
		'#......###',
		'#.....##..',
		'.##.#..#..',
		'.##...#...',
		'#.###...##',
		'Tile 2221:',
		'###.######',
		'.##......#',
		'##...#...#',
		'..........',
		'....#.#..#',
		'#..#.....#',
		'##..##...#',
		'##..##....',
		'.#.....#..',
		'..########',
		'Tile 2297:',
		'.###..##.#',
		'#..###....',
		'..#..#..##',
		'....######',
		'##.......#',
		'.......#.#',
		'#.....#..#',
		'###....#.#',
		'#....##..#',
		'....##.#..',
		'Tile 2269:',
		'##.....#..',
		'.###..###.',
		'#..##.....',
		'....#.....',
		'#..#...#.#',
		'#....#..#.',
		'#...###.##',
		'.........#',
		'....#.....',
		'##.....#.#',
		'Tile 2287:',
		'#########.',
		'##...#.###',
		'#..#.#....',
		'..##..####',
		'....#.....',
		'#....#.#.#',
		'......#..#',
		'#......#..',
		'##..##....',
		'##.......#',
		'Tile 2399:',
		'#.#.#..###',
		'....#.....',
		'#....##..#',
		'##..#....#',
		'#.#.#.....',
		'.#...#..#.',
		'#.#...#..#',
		'.....##..#',
		'#...##...#',
		'#..##.##.#',
		'Tile 1423:',
		'##...#.#..',
		'#.#...#.#.',
		'.###..#..#',
		'.........#',
		'#...#...#.',
		'#....##.##',
		'#......#..',
		'##..##...#',
		'.#......##',
		'...#.###.#',
		'Tile 2621:',
		'###.....#.',
		'..#....#..',
		'......#...',
		'##.......#',
		'.#.#..##..',
		'#.#.##...#',
		'#...#..#.#',
		'#..###.#.#',
		'###.......',
		'..#.......',
		'Tile 2003:',
		'..#..#####',
		'#.#.....#.',
		'#..#.#...#',
		'.#....#...',
		'#.#.##.##.',
		'##.#..##.#',
		'.####..#.#',
		'#.#...#..#',
		'..####.#.#',
		'..#..###.#',
		'Tile 3889:',
		'.#.##.#.##',
		'.........#',
		'######..##',
		'...#...#..',
		'#.....#..#',
		'....#....#',
		'#........#',
		'...#.#.#.#',
		'#..##..#..',
		'..##..#...',
		'Tile 1667:',
		'#...####.#',
		'#######..#',
		'#.........',
		'........##',
		'.....##...',
		'#...###..#',
		'...#.....#',
		'#..#....#.',
		'.#.#.##..#',
		'..#.###.#.',
		'Tile 1877:',
		'...#......',
		'.#.#.#..#.',
		'.....##..#',
		'..........',
		'...#.#....',
		'#.##....##',
		'#.#..##...',
		'#..##..#..',
		'#.........',
		'##..#...##',
		'Tile 2657:',
		'#.#..####.',
		'.....#...#',
		'........#.',
		'#.#......#',
		'#..##.....',
		'#........#',
		'...##.#...',
		'#....#.#..',
		'.......#.#',
		'########..',
		'Tile 1669:',
		'.###.####.',
		'......###.',
		'.#.##...##',
		'..##...#..',
		'##......##',
		'.#........',
		'###..#.###',
		'.##...#.#.',
		'....###.##',
		'.####....#',
		'Tile 2843:',
		'#...#.#.##',
		'.#.....#..',
		'##.#....##',
		'##.#..####',
		'##........',
		'..#.....##',
		'.#.#......',
		'##..#.#...',
		'.#.#.....#',
		'.#.#....##',
		'Tile 2243:',
		'..#....##.',
		'.#.......#',
		'......#..#',
		'##......#.',
		'#.##.....#',
		'........#.',
		'#..#.#...#',
		'##..#..#..',
		'...#...#.#',
		'....####.#',
		'Tile 1543:',
		'..#..##...',
		'..##..##.#',
		'...#......',
		'#.......##',
		'......#.##',
		'.#...#....',
		'#.##....##',
		'##..##.#.#',
		'#.###....#',
		'######.#.#',
		'Tile 1777:',
		'##.##..###',
		'#.#...##..',
		'........##',
		'##.#......',
		'.#....##..',
		'#........#',
		'......#...',
		'#.........',
		'.........#',
		'#..###....',
		'Tile 2161:',
		'########.#',
		'....#.....',
		'####.#....',
		'#.####....',
		'..###..#..',
		'.#..#....#',
		'...#####..',
		'#....#....',
		'......#..#',
		'######.#.#',
		'Tile 3167:',
		'.#.....##.',
		'#..#.....#',
		'...###..##',
		'#.#.......',
		'#.###.....',
		'.#......#.',
		'.##.##.#.#',
		'.#.#..##..',
		'..#...#.##',
		'##.#..#.#.',
		'Tile 1279:',
		'#.....#..#',
		'#...###.#.',
		'##..###.#.',
		'..#....#.#',
		'#..#......',
		'.#.....#.#',
		'....#...#.',
		'#.......#.',
		'#.........',
		'....###.##',
		'Tile 2711:',
		'##.###..##',
		'.......###',
		'#...#..###',
		'#.........',
		'#####.#...',
		'#..#.###..',
		'......#...',
		'##.......#',
		'....#....#',
		'..####..#.',
		'Tile 1087:',
		'...#.##...',
		'#....#..##',
		'.....##.##',
		'.#...#...#',
		'.##..#..##',
		'#...#....#',
		'..#.......',
		'##........',
		'#.#.###...',
		'##.##..###',
		'Tile 3947:',
		'.##...###.',
		'##......#.',
		'.#........',
		'........##',
		'........##',
		'#..###...#',
		'##.......#',
		'#....##..#',
		'#........#',
		'#.##..#..#',
		'Tile 1571:',
		'#######..#',
		'..#.#...#.',
		'.........#',
		'..#......#',
		'.........#',
		'#.......##',
		'...#..##.#',
		'.#..#.....',
		'#..#.#....',
		'#.#....###',
		'Tile 2521:',
		'..#.#.####',
		'#........#',
		'..........',
		'..#...#...',
		'....##...#',
		'...#...#..',
		'#.#.#...##',
		'#.........',
		'.#...#.##.',
		'##.#####.#',
		'Tile 3533:',
		'...#.#.#.#',
		'..#.......',
		'.........#',
		'...#......',
		'##..#.#...',
		'...#..#.##',
		'.#...#.#.#',
		'..#..###.#',
		'###...#.##',
		'#.#.......',
		'Tile 2339:',
		'#.#####...',
		'..##......',
		'#...##...#',
		'#.#.#.....',
		'#......##.',
		'#...#...#.',
		'......#.##',
		'....##..##',
		'..#.#..###',
		'##..##...#',
		'Tile 1493:',
		'###..####.',
		'..##.....#',
		'.........#',
		'..#.#...##',
		'..#......#',
		'..##....##',
		'.#..##.##.',
		'.........#',
		'##.#.#...#',
		'#.#..#.#.#',
		'Tile 1637:',
		'###.##.#.#',
		'.....#....',
		'#....##..#',
		'#.....#...',
		'..###.##..',
		'#.#.......',
		'##.#...##.',
		'....#....#',
		'#...#.##..',
		'..#..####.',
		'Tile 2153:',
		'.#.##.#...',
		'.....#...#',
		'......#...',
		'...#.#...#',
		'#.#..##...',
		'...#..#...',
		'#.##.#..#.',
		'.#.....#..',
		'.......#.#',
		'###...#.#.',
		'Tile 1129:',
		'..#.###...',
		'#.####..##',
		'#......#..',
		'###.......',
		'##......#.',
		'#.#..#..##',
		'#..##...##',
		'.#......#.',
		'.#........',
		'#######..#',
		'Tile 3581:',
		'#...##.##.',
		'#####..#..',
		'#.##.#####',
		'.....#....',
		'#.........',
		'.....#...#',
		'.#........',
		'#........#',
		'##...#.#.#',
		'..##..#...',
		'Tile 1303:',
		'####.##...',
		'#...##....',
		'#.##......',
		'#.....#...',
		'#....##...',
		'####.#.###',
		'#.#.#.#..#',
		'#..#....##',
		'#.#....#..',
		'.#.##.....',
		'Tile 3209:',
		'##..##.###',
		'...#.##...',
		'##..##.#.#',
		'..#.....#.',
		'#.###...##',
		'##.#.#....',
		'###......#',
		'....##....',
		'#........#',
		'.###.#..#.',
		'Tile 3613:',
		'##..####..',
		'.#...#...#',
		'#.##......',
		'...#......',
		'#.....#.#.',
		'##.#.##...',
		'......#.##',
		'#.........',
		'#.#...#...',
		'###.#.....',
		'Tile 3833:',
		'......###.',
		'#.#......#',
		'#..#......',
		'.#.#..#...',
		'#.#.#....#',
		'.....#....',
		'#.....#...',
		'.........#',
		'##....###.',
		'....#..##.',
		'Tile 2089:',
		'.#..###.##',
		'##.##...#.',
		'##..##..##',
		'.#.#..#...',
		'.#....#...',
		'##.....#.#',
		'...#.....#',
		'.#..#....#',
		'##..##...#',
		'##..#.#.##',
		'Tile 1553:',
		'..#.##....',
		'#..##...#.',
		'#.#..#...#',
		'.##..#...#',
		'##..###...',
		'##.#.#....',
		'#..#.#.###',
		'.........#',
		'......#..#',
		'#.#.#....#',
		'Tile 2213:',
		'#####....#',
		'..###..#..',
		'...#......',
		'.........#',
		'.#.###....',
		'#.........',
		'.....##.##',
		'###......#',
		'#...#####.',
		'.##.##..##',
		'Tile 3347:',
		'..#..#####',
		'#.##...#..',
		'##.#..####',
		'...###..#.',
		'#.##......',
		'.#.##..#..',
		'#.##.#..#.',
		'###...##..',
		'#.#..#.#.#',
		'#.#...##..',
		'Tile 3203:',
		'#.####.#.#',
		'#......#.#',
		'#..#...#.#',
		'.#........',
		'#......#..',
		'#.###...#.',
		'........##',
		'..##...#.#',
		'..........',
		'#...#..##.',
		'Tile 1811:',
		'.##.####.#',
		'.#......##',
		'.......#.#',
		'#...##.##.',
		'#.......#.',
		'#.#.#.####',
		'.#.......#',
		'....#...#.',
		'......###.',
		'#...#..###',
		'Tile 1531:',
		'##...#.#.#',
		'.##......#',
		'#........#',
		'#...#.....',
		'#...###..#',
		'...#.#....',
		'#.......#.',
		'.#..###.#.',
		'.....####.',
		'##.#.####.',
		'Tile 3191:',
		'##..###.##',
		'#.###...#.',
		'..#....#.#',
		'##.#...###',
		'..#.......',
		'.....#....',
		'#......#.#',
		'.........#',
		'..##.#...#',
		'...##.....',
		'Tile 3259:',
		'...###..##',
		'#...#....#',
		'#.....#.#.',
		'.#...#...#',
		'.........#',
		'.........#',
		'...#.....#',
		'#.....##.#',
		'..#...#..#',
		'...##.####',
		'Tile 1579:',
		'.#.##.#..#',
		'.#.#.#....',
		'...#.....#',
		'#..#.....#',
		'....#....#',
		'#.#..#.###',
		'#.#.#.....',
		'##.......#',
		'##.....##.',
		'.###.....#',
		'Tile 1861:',
		'...##.#...',
		'...#.....#',
		'#.#.####..',
		'......#..#',
		'#....#...#',
		'..#.#.##..',
		'.#........',
		'.##.#.#..#',
		'##.....#..',
		'...###.###',
		'Tile 2857:',
		'###.#.##..',
		'.......#.#',
		'#...#.....',
		'##.#.....#',
		'.#....#.#.',
		'#.....#.##',
		'#......#.#',
		'#.....#..#',
		'#.#.#....#',
		'.#..#....#',
		'Tile 3853:',
		'...###...#',
		'#.#.##..##',
		'#.......##',
		'..####..##',
		'.#........',
		'..........',
		'...##.....',
		'....#....#',
		'#........#',
		'.#.##..###',
		'Tile 3917:',
		'#.#.###.##',
		'..........',
		'#..#.#....',
		'#.#....#.#',
		'##..#...##',
		'##.....#..',
		'#.#....#..',
		'.#.....#..',
		'..#.....#.',
		'######.###',
		'Tile 1999:',
		'.######...',
		'.##.#....#',
		'..#.......',
		'.......#.#',
		'.........#',
		'........#.',
		'#..#.#####',
		'##....##..',
		'#.#.....#.',
		'.##.##....',
		'Tile 3719:',
		'..#..##...',
		'##.###....',
		'####..#.#.',
		'#.....#...',
		'#..##.#..#',
		'....#.###.',
		'.##..#...#',
		'......#..#',
		'.#.#....#.',
		'#....###.#',
		'Tile 3491:',
		'....#.##..',
		'#..#.#...#',
		'.#..###..#',
		'#...#.....',
		'#..#...###',
		'..#.#.....',
		'##.#.....#',
		'..##.###.#',
		'#.##.....#',
		'..#.#.####',
		'Tile 3499:',
		'#.##.#...#',
		'#...#.####',
		'.....#....',
		'#.....#.##',
		'.#........',
		'.#.#...#..',
		'.##.#.##..',
		'....#....#',
		'##...#..#.',
		'#.#..##...',
		'Tile 2311:',
		'..#.#...##',
		'#.#.......',
		'.........#',
		'#.....#...',
		'#..#...#..',
		'..##......',
		'....#...#.',
		'#..##...##',
		'#.........',
		'.#...###..',
		'Tile 1459:',
		'####.#...#',
		'..#.####.#',
		'.#.......#',
		'..#.#....#',
		'..........',
		'#.....#.#.',
		'#.....#...',
		'###.#....#',
		'..##..#...',
		'....#..##.',
		'Tile 1447:',
		'.##.##....',
		'.##....#..',
		'######.#.#',
		'..........',
		'#.........',
		'#...#.##.#',
		'#...##...#',
		'#.......##',
		'....#.....',
		'.##.#..#..',
		'Tile 2579:',
		'##...##...',
		'#..#.#..##',
		'...##.#..#',
		'#.#......#',
		'.#....#...',
		'.##......#',
		'#..#..#..#',
		'..#...#.##',
		'#..##....#',
		'.##..###.#',
		'Tile 2531:',
		'#...#..###',
		'.#..#.###.',
		'#......##.',
		'.##..#.#..',
		'.....#..##',
		'.....#.#..',
		'#.#....#..',
		'....#...#.',
		'.......#..',
		'.#.##..#.#',
		'Tile 1019:',
		'....####..',
		'#....#.#..',
		'#.#.#....#',
		'.#...#...#',
		'..#.#....#',
		'#....##...',
		'..#.###..#',
		'#..#..#..#',
		'..#.#.....',
		'..##.#..#.',
		'Tile 1151:',
		'#..#.#.#..',
		'#.....#...',
		'.#..#.#.##',
		'..###....#',
		'..##..#.#.',
		'.#..##....',
		'#...#..##.',
		'..#.###.#.',
		'.#...#....',
		'..###....#',
		'Tile 3767:',
		'.#...###.#',
		'...#.##...',
		'#....###..',
		'...#..#..#',
		'#...##....',
		'##...#....',
		'.##...###.',
		'#...####..',
		'##...###..',
		'..##.#....',
		'Tile 1871:',
		'......#..#',
		'#.#..#....',
		'.........#',
		'......##.#',
		'#....#....',
		'##..#.##.#',
		'#.....#.##',
		'#..#.....#',
		'.#.#..#...',
		'##.##...#.',
		'Tile 2953:',
		'#..##..#.#',
		'#...#.....',
		'.##.......',
		'.#..#.....',
		'##........',
		'#.#..#.#.#',
		'...##....#',
		'...#....##',
		'..#.#.....',
		'.##...#.##',
		'Tile 1153:',
		'.#..######',
		'.#.#.....#',
		'#.....#...',
		'##...#.##.',
		'#...#....#',
		'.#..#.#.#.',
		'##...##...',
		'.#.#.....#',
		'..##..#..#',
		'.......##.',
		'Tile 3359:',
		'#.#####.##',
		'#...#....#',
		'#..#...#..',
		'.#.##....#',
		'###.....##',
		'.#..#.#..#',
		'#........#',
		'.##...#...',
		'#.........',
		'...#...#..',
		'Tile 3257:',
		'...#.####.',
		'##.##....#',
		'.......#.#',
		'#........#',
		'#...#....#',
		'#...#....#',
		'.#...#..#.',
		'#...#....#',
		'###.....##',
		'.....#####',
		'Tile 2557:',
		'##..######',
		'.........#',
		'..##...#.#',
		'#....#..##',
		'...#.#..#.',
		'.#.....##.',
		'...##...##',
		'..#.#...##',
		'....#.#...',
		'#.##...###',
		'Tile 2851:',
		'.#....####',
		'#......#.#',
		'#...#..#.#',
		'#......#..',
		'.#...#....',
		'#.......#.',
		'........#.',
		'#......#.#',
		'...#.....#',
		'......##..',
		'Tile 1103:',
		'#...#.....',
		'#..#..#...',
		'...##.#..#',
		'....###.##',
		'....#..##.',
		'.#..###...',
		'##.....###',
		'...#...#.#',
		'......##.#',
		'.#.#.#.##.',
		'Tile 1801:',
		'##.#...##.',
		'....##..#.',
		'#.......#.',
		'.##...##..',
		'......##..',
		'.#...##..#',
		'.#..#..#..',
		'...#.#..##',
		'##.....#..',
		'#.#.#.#...',
		'Tile 2731:',
		'#.#.#.#..#',
		'#.#....###',
		'#####..#..',
		'#...#.....',
		'#.#...####',
		'#.........',
		'.#.....#..',
		'..#.......',
		'#......#.#',
		'..#.#.##..',
		'Tile 2111:',
		'..##...#..',
		'#...#..###',
		'......##.#',
		'..#.......',
		'#........#',
		'#.......#.',
		'#...##...#',
		'#....#...#',
		'..#...#...',
		'.#....###.',
		'Tile 1613:',
		'..###..#..',
		'#...##...#',
		'#.........',
		'#...#.#..#',
		'#.###...#.',
		'#.##..#...',
		'#......##.',
		'##.#......',
		'..#...#..#',
		'.##...###.',
		'Tile 3739:',
		'#.#.#.#..#',
		'###.#....#',
		'..#..##.#.',
		'.#..#...#.',
		'#.####....',
		'.#......#.',
		'#....#...#',
		'.........#',
		'##..#....#',
		'#...#.#.##',
		'Tile 1297:',
		'.##..#.##.',
		'#.#...#.##',
		'#...##..##',
		'.#..##.###',
		'#...#.....',
		'.##.#....#',
		'........#.',
		'.####..#..',
		'..#.....#.',
		'###..##..#',
		'Tile 2029:',
		'#.....#.##',
		'#.#..#...#',
		'#.####..#.',
		'....#.#.#.',
		'#...#.#...',
		'#......###',
		'......##..',
		'.........#',
		'......##.#',
		'#.###.#..#',
		'Tile 1093:',
		'#.#..#..##',
		'##......#.',
		'#.........',
		'#.........',
		'....#....#',
		'#....###.#',
		'#.#.....##',
		'..#.......',
		'.#.#....#.',
		'#.###.#.##',
		'Tile 2357:',
		'#..#.##..#',
		'..#.......',
		'...#..#..#',
		'.#.....##.',
		'##.#...#.#',
		'#.#.....#.',
		'##.......#',
		'#.#..##...',
		'#....#..##',
		'#.###..###',
		'Tile 1231:',
		'.######...',
		'#..##.....',
		'#........#',
		'#........#',
		'..........',
		'....#...#.',
		'#.##.#..##',
		'##..#.##..',
		'......#.##',
		'.#...##...',
		'Tile 2671:',
		'####..###.',
		'..#.......',
		'...#..#...',
		'#.#.......',
		'.#.#..#...',
		'##.##....#',
		'#....##.#.',
		'#...#....#',
		'#...#.....',
		'..#..##.#.',
		'Tile 3137:',
		'.#..##...#',
		'...#.#..##',
		'#...#....#',
		'#....#...#',
		'.##..##.#.',
		'#.#....#..',
		'#.#.....##',
		'#..##...##',
		'#.....##..',
		'#.#.###.#.',
		'Tile 1229:',
		'...#######',
		'#.#...#..#',
		'..#.....#.',
		'#.##.##.#.',
		'.##.#..##.',
		'....####..',
		'..##..#...',
		'#...#.....',
		'#..###.#..',
		'#.###..##.',
		'Tile 1979:',
		'#..#....##',
		'#....#...#',
		'.#.#....##',
		'.......#.#',
		'..#..##..#',
		'#.#...##.#',
		'...#..#..#',
		'#....#..##',
		'##......#.',
		'.######..#',
		'Tile 2341:',
		'.#.##.....',
		'###......#',
		'........#.',
		'##...#..#.',
		'#...#...#.',
		'#...##.#..',
		'...#..#..#',
		'..##.....#',
		'#...##.#.#',
		'...#..#.##',
		'Tile 1373:',
		'.#####..##',
		'#.#.....#.',
		'........##',
		'.........#',
		'....###.##',
		'#.##.##..#',
		'###.#.##..',
		'..#.....#.',
		'.........#',
		'#.#.###.##',
		'Tile 1483:',
		'#.#..#..##',
		'.##.###...',
		'#.........',
		'#..#......',
		'#...##....',
		'.##.....#.',
		'.#...#.#..',
		'..#......#',
		'..#.#.#...',
		'.##.######',
		'Tile 3109:',
		'.##.###.#.',
		'....###.#.',
		'#...#.....',
		'#.......##',
		'.#.#..####',
		'..#..#####',
		'##...#.#..',
		'..##.....#',
		'#..#..####',
		'##..#.#...',
		'Tile 3449:',
		'##.###..#.',
		'....#.#...',
		'#...#.....',
		'....##..#.',
		'.##.#.#.##',
		'.##..###.#',
		'....##...#',
		'...###....',
		'#....#...#',
		'.#...#.#..',
		'Tile 2969:',
		'##..#.##..',
		'.#..###..#',
		'...###.#.#',
		'..#....#..',
		'#####.....',
		'.#.##....#',
		'.......#.#',
		'.........#',
		'.#......#.',
		'......#.#.',
		'Tile 3877:',
		'##..#...##',
		'....#....#',
		'#..##.....',
		'.....#....',
		'#......#..',
		'.#...#...#',
		'......##.#',
		'##.....##.',
		'..#..#...#',
		'##..###.#.',
		'Tile 3539:',
		'..#...##..',
		'........#.',
		'..#.#....#',
		'##.#.##..#',
		'#...#..#..',
		'..#.......',
		'.#...##...',
		'...#.##.#.',
		'#..##..##.',
		'......#.#.',
		'Tile 3547:',
		'####..#..#',
		'........##',
		'##.#...#.#',
		'...##...##',
		'.#..###..#',
		'##.###..#.',
		'.#..##..##',
		'#....##...',
		'......#...',
		'.##.###..#',
		'Tile 3863:',
		'..#.##.###',
		'....#.#..#',
		'..#...#..#',
		'##.#.#..##',
		'.##.......',
		'#.#...##..',
		'#.#...##.#',
		'.#.#....##',
		'#.#...#.##',
		'##..##....',
		'Tile 2437:',
		'#.##.#####',
		'.#....#..#',
		'#....#....',
		'.....##..#',
		'#..#.#..#.',
		'......#...',
		'..##.#.#..',
		'..##......',
		'.#..##...#',
		'####.#####',
		'Tile 2267:',
		'#..###..##',
		'.#........',
		'###.#....#',
		'....#.....',
		'#.....#..#',
		'..#.......',
		'......####',
		'.#........',
		'#.#......#',
		'...##.....',
		'Tile 3671:',
		'#.##.#####',
		'..#..##...',
		'..........',
		'##.....#.#',
		'.###......',
		'###.....##',
		'##..#....#',
		'#....#....',
		'##......##',
		'###.#.#..#',
		'Tile 3041:',
		'#...######',
		'.........#',
		'.#....####',
		'#.##......',
		'.##...#...',
		'##..#....#',
		'.#.#...#.#',
		'#..#.###..',
		'##..#....#',
		'##..#.###.',
		'Tile 2467:',
		'#####...#.',
		'#.#.#.....',
		'##........',
		'##...#....',
		'.......##.',
		'##......#.',
		'##.#..####',
		'....##...#',
		'####..#..#',
		'#.#.#..###',
		'Tile 3593:',
		'..##.##..#',
		'..........',
		'.#.###..#.',
		'......##..',
		'..........',
		'........#.',
		'##...#.#.#',
		'...##.#..#',
		'...##....#',
		'..##..#.##',
		'Tile 3061:',
		'####.##.#.',
		'..##....#.',
		'###..#...#',
		'..........',
		'.####...#.',
		'..##..#...',
		'...#......',
		'##..#..##.',
		'#.#...#..#',
		'###.###..#',
		'Tile 1409:',
		'#.#.#...#.',
		'#....#..##',
		'......#...',
		'..........',
		'.#..##...#',
		'###......#',
		'#..#.#...#',
		'###....#..',
		'#.......##',
		'#..##.#.#.',
		'Tile 2207:',
		'..#.##.###',
		'#........#',
		'.........#',
		'..#.#...#.',
		'#.##......',
		'....##....',
		'..#.#..##.',
		'###.....#.',
		'.###...#.#',
		'#...#.##..',
		'Tile 1069:',
		'..#....###',
		'#...#.....',
		'.....#..#.',
		'.###...#.#',
		'..###....#',
		'..........',
		'#.....#..#',
		'#.#..#..#.',
		'#..##....#',
		'...##...##',
		'Tile 1187:',
		'#...##..#.',
		'#......#.#',
		'#.......##',
		'##.....###',
		'.#...#.##.',
		'##.#......',
		'###.#...##',
		'#.##...#..',
		'#....#....',
		'#.......#.',
		'Tile 2549:',
		'.###.....#',
		'##.#.#..##',
		'#...#..##.',
		'##.......#',
		'#.........',
		'.#.#..#.##',
		'..........',
		'##...#...#',
		'#....#...#',
		'#####...##',
		'Tile 2593:',
		'#.#..##...',
		'...##...##',
		'.##..##.##',
		'.#..#....#',
		'....####.#',
		'........#.',
		'.###.....#',
		'....##..##',
		'#..#....##',
		'.##..#.#..',
		'Tile 1277:',
		'.#.#...##.',
		'..##.#.###',
		'....#...##',
		'......#.#.',
		'..##.#.#.#',
		'.....#..##',
		'..#...##.#',
		'....#..#.#',
		'##..###...',
		'#....#####',
		'Tile 2251:',
		'#..###..##',
		'#....##...',
		'###...##.#',
		'.#.####.##',
		'#.##....#.',
		'.#...#....',
		'#.......##',
		'.#.#....#.',
		'#.....#..#',
		'###...##..',
		'Tile 1061:',
		'.#.#....##',
		'#.........',
		'.....#..##',
		'...#..#...',
		'..........',
		'#..##.##.#',
		'#...#...##',
		'##.......#',
		'..#.##....',
		'#.#..#...#',
		'Tile 3037:',
		'#.....#.##',
		'........#.',
		'........#.',
		'##..##..#.',
		'.##.##....',
		'##..#...#.',
		'#....#.###',
		'...#..#.#.',
		'#.#####..#',
		'...###.##.',
		'Tile 3823:',
		'.###..#...',
		'#...#.....',
		'....#.#...',
		'#.#..###..',
		'##.#..#.##',
		'.####....#',
		'.###.....#',
		'.#...#...#',
		'#..#####..',
		'..###...#.',
		'Tile 2087:',
		'.#...#.###',
		'.#.##..###',
		'.....#...#',
		'#...#.....',
		'...#.#....',
		'........##',
		'........##',
		'#..#..#..#',
		'.#....##..',
		'####...###',
		'Tile 1321:',
		'#.###.##.#',
		'#...#.....',
		'.##.#...##',
		'#.....#..#',
		'.#...#....',
		'...##.....',
		'#..##.....',
		'#..#...##.',
		'#........#',
		'###.###.#.',
		'Tile 1951:',
		'###.####.#',
		'#...#.....',
		'#.#.#.###.',
		'..##...#.#',
		'#.#..#..#.',
		'##.#.....#',
		'#......#..',
		'.#........',
		'.#.......#',
		'..##...#.#',
		'Tile 3847:',
		'.###.#..##',
		'#..##..#..',
		'..#....#..',
		'#...#...##',
		'#.........',
		'.#...#....',
		'.##.#...##',
		'..#.#..###',
		'...#..##.#',
		'##.#.##..#',
		'Tile 3851:',
		'...##.##..',
		'....#..#.#',
		'.###..#..#',
		'..........',
		'..........',
		'#........#',
		'##..#....#',
		'#......#.#',
		'.....#.#..',
		'.###.#.#..',
		'Tile 3407:',
		'#####.#.##',
		'.......#..',
		'#.....#...',
		'#...##....',
		'........#.',
		'...##.#.#.',
		'.##....##.',
		'#.....#...',
		'....#.....',
		'#..#..#...',
		'Tile 1709:',
		'....#.#..#',
		'....##.###',
		'#.....#..#',
		'#......#.#',
		'.......###',
		'..........',
		'#.#.#....#',
		'..#...##.#',
		'#..#...#.#',
		'.##.#.##..',
		'Tile 1097:',
		'#.###.##.#',
		'.........#',
		'....##.#..',
		'...#.#..##',
		'..#.#....#',
		'..#..##..#',
		'#####....#',
		'#.#..###..',
		'....#.....',
		'######.##.',
		'Tile 3301:',
		'.#..#..#..',
		'.#........',
		'#..#.#....',
		'......#..#',
		'#....#..##',
		'#........#',
		'#.....#.##',
		'#....#...#',
		'...#.#..#.',
		'..####.###',
		'Tile 3517:',
		'#####.##..',
		'#...##..##',
		'.#..#.....',
		'#...#....#',
		'..#.#...##',
		'####..##..',
		'#.#..#..#.',
		'.....#....',
		'.....#.#.#',
		'..#..####.',
		'Tile 2137:',
		'#...##.##.',
		'..#...#.##',
		'#..#.....#',
		'##...###.#',
		'.#.#...#.#',
		'..##..#..#',
		'..#......#',
		'#.#####.##',
		'#..#......',
		'####......',
		'Tile 3623:',
		'#.##.##.#.',
		'.#..#....#',
		'#..##.##..',
		'...##....#',
		'###..#....',
		'..##.#....',
		'.....#.###',
		'......#...',
		'#.........',
		'#...#..##.',
		'Tile 1867:',
		'#..#.##.##',
		'..#..##...',
		'#.##......',
		'##...##..#',
		'..#...##..',
		'#.#.#....#',
		'.........#',
		'.##.##....',
		'...##.....',
		'##...###.#',
		'Tile 1787:',
		'.#..#.##..',
		'...#......',
		'....#..#..',
		'##.#.#.#..',
		'...##....#',
		'...#......',
		'###......#',
		'..........',
		'.......##.',
		'####..#...',
		'Tile 2591:',
		'....###.##',
		'#..#....#.',
		'......#..#',
		'#........#',
		'.....#....',
		'###.#....#',
		'.....###..',
		'###.......',
		'......#..#',
		'..#.#.#...',
		'Tile 1607:',
		'.#.#..####',
		'#.....##..',
		'#..#.....#',
		'..###...##',
		'.......###',
		'#..##.....',
		'...#......',
		'#...#...#.',
		'#.....#.#.',
		'...#...#..',
		'Tile 3271:',
		'.#.###.###',
		'#........#',
		'.#........',
		'####....#.',
		'.......#..',
		'#.....#..#',
		'##.##.##..',
		'.#........',
		'#......#..',
		'.#..####.#',
		'Tile 2063:',
		'#...##.#.#',
		'##...##.#.',
		'.##.##.#..',
		'#..#...#.#',
		'..#.#....#',
		'.##...##..',
		'.#.#.#....',
		'#...#....#',
		'.#........',
		'..#.#.#.##',
		'Tile 1289:',
		'.#..##....',
		'..#..##...',
		'.#....#...',
		'.......#.#',
		'##..#...#.',
		'...##...##',
		'...##.....',
		'.##.#....#',
		'##.....#..',
		'..#.###.#.',
		'Tile 1213:',
		'..#..##.#.',
		'#.#..#.#..',
		'#.........',
		'#..#...#..',
		'#...#...##',
		'..#.......',
		'...##.#...',
		'.##.#.....',
		'##.##....#',
		'####.#.###'
	];

	//Test:
	private const INPUT1 = 
	[
		'Tile 2311:',
		'..##.#..#.',
		'##..#.....',
		'#...##..#.',
		'####.#...#',
		'##.##.###.',
		'##...#.###',
		'.#.#.#..##',
		'..#....#..',
		'###...#.#.',
		'..###..###',
		'Tile 1951:',
		'#.##...##.',
		'#.####...#',
		'.....#..##',
		'#...######',
		'.##.#....#',
		'.###.#####',
		'###.##.##.',
		'.###....#.',
		'..#.#..#.#',
		'#...##.#..',
		'Tile 1171:',
		'####...##.',
		'#..##.#..#',
		'##.#..#.#.',
		'.###.####.',
		'..###.####',
		'.##....##.',
		'.#...####.',
		'#.##.####.',
		'####..#...',
		'.....##...',
		'Tile 1427:',
		'###.##.#..',
		'.#..#.##..',
		'.#.##.#..#',
		'#.#.#.##.#',
		'....#...##',
		'...##..##.',
		'...#.#####',
		'.#.####.#.',
		'..#..###.#',
		'..##.#..#.',
		'Tile 1489:',
		'##.#.#....',
		'..##...#..',
		'.##..##...',
		'..#...#...',
		'#####...#.',
		'#..#.#.#.#',
		'...#.#.#..',
		'##.#...##.',
		'..##.##.##',
		'###.##.#..',
		'Tile 2473:',
		'#....####.',
		'#..#.##...',
		'#.##..#...',
		'######.#.#',
		'.#...#.#.#',
		'.#########',
		'.###.#..#.',
		'########.#',
		'##...##.#.',
		'..###.#.#.',
		'Tile 2971:',
		'..#.#....#',
		'#...###...',
		'#.#.###...',
		'##.##..#..',
		'.#####..##',
		'.#..####.#',
		'#..#.#..#.',
		'..####.###',
		'..#.#.###.',
		'...#.#.#.#',
		'Tile 2729:',
		'...#.#.#.#',
		'####.#....',
		'..#.#.....',
		'....#..#.#',
		'.##..##.#.',
		'.#.####...',
		'####.#.#..',
		'##.####...',
		'##..#.##..',
		'#.##...##.',
		'Tile 3079:',
		'#.#.#####.',
		'.#..######',
		'..#.......',
		'######....',
		'####.#..#.',
		'.#...#.##.',
		'#.#####.##',
		'..#.###...',
		'..#.......',
		'..#.###...'
	];

	
	public function run()
	{
		set_time_limit(0);
		
		//Create the tile helper and caluclate the whole image
		Helper::start();
		$tileHelper = new TileHelper($this::INPUT);
		$image = $tileHelper->buildImage();
		$d1 = Helper::end();

		//Removed borders, connect, and count monsters
		Helper::start();
		$imageProcessor = new ImageProcessor($image);
		$monsters = $imageProcessor->countMonsters();
		$roughness = $imageProcessor->countRoughness($monsters);
		$d2 = Helper::end();

		echo "The roughness ist <b>$roughness</b><br>";
		echo "<small>And there are $monsters sea monsters - watch out! Druation image generation: $d1 sec. Duration monster search: $d2 sec.</small>";

		//Show them sea fuckers:
		$imageProcessor->print(false);

	}
}

class ImageProcessor
{
	/** @var string[] $image */
	private $image = [];
	private $hasBorders = true;
	
	/**
	 * @param Tile[][] $image
	 */
	public function __construct(array $image)
	{			
		$image = 
		$this->image = $this->createFlatImage($image, true);
	}

	public function countRoughness()
	{
		$max = count($this->image);
		$total = 0;
		for($r = 0; $r < $max; $r++)
		{
			for($c = 0; $c < $max; $c++)
			{
				$total += $this->image[$r][$c] === '#' ? 1 : 0;
			}
		}

		return $total;
	} 

	/** @return int */
	public function countMonsters(int $iteration = 0)
	{
		if($iteration >= 8)
		{
			throw new Exception('Cannot find monsters!');
		}

		//Ugly, but fast:
		$max = count($this->image);
		$found = 0;
		for($r = 0; $r < $max; $r++)
		{
			for($c = 0; $c < $max; $c++)
			{
				if
				(
					isset($this->image[$r][$c]) && $this->image[$r][$c] === '#' &&
					isset($this->image[$r+1][$c+1]) && $this->image[$r+1][$c+1] === '#' &&
					isset($this->image[$r+1][$c]) && $this->image[$r+1][$c] === '#' &&
					isset($this->image[$r+1][$c-1]) && $this->image[$r+1][$c-1] === '#' &&
					isset($this->image[$r+1][$c-6]) && $this->image[$r+1][$c-6] === '#' &&
					isset($this->image[$r+1][$c-7]) && $this->image[$r+1][$c-7] === '#' &&
					isset($this->image[$r+1][$c-12]) && $this->image[$r+1][$c-12] === '#' &&
					isset($this->image[$r+1][$c-13]) && $this->image[$r+1][$c-13] === '#' &&
					isset($this->image[$r+1][$c-18]) && $this->image[$r+1][$c-18] === '#' &&
					isset($this->image[$r+2][$c-2]) && $this->image[$r+2][$c-2] === '#' &&
					isset($this->image[$r+2][$c-5]) && $this->image[$r+2][$c-5] === '#' &&
					isset($this->image[$r+2][$c-8]) && $this->image[$r+2][$c-8] === '#' &&
					isset($this->image[$r+2][$c-10]) && $this->image[$r+2][$c-11] === '#' &&
					isset($this->image[$r+2][$c-14]) && $this->image[$r+2][$c-14] === '#' &&
					isset($this->image[$r+2][$c-17]) && $this->image[$r+2][$c-17] === '#'
				)
				{
					$found++;
					
					$this->image[$r][$c] = 'O';
					$this->image[$r+1][$c+1] = 'O';
					$this->image[$r+1][$c] = 'O';
					$this->image[$r+1][$c-1] = 'O';
					$this->image[$r+1][$c-6] = 'O';
					$this->image[$r+1][$c-7] = 'O';
					$this->image[$r+1][$c-12]  = 'O';
					$this->image[$r+1][$c-13] = 'O';
					$this->image[$r+1][$c-18] = 'O';
					$this->image[$r+2][$c-2] = 'O';
					$this->image[$r+2][$c-5] = 'O';
					$this->image[$r+2][$c-8] = 'O';
					$this->image[$r+2][$c-11] = 'O';
					$this->image[$r+2][$c-14] = 'O';
					$this->image[$r+2][$c-17]  = 'O';
				}
			}
		}
		
		if($found > 0)
		{
			return $found;	
		}

		$this->rotateRight();
		if($iteration === 3)
		{
			$this->flip();
		}

		return $this->countMonsters($iteration + 1);
	}

	private function flip()
	{
		$this->image = array_reverse($this->image);
	}

	private function rotateRight()
	{
		$d = $this->image;
		$lmax = count($d);
		for($l = 0; $l < $lmax; $l++)
		{
			for($i = 0; $i < $lmax; $i++)
			{
				$d[$l][$i] = $this->image[$lmax-1-$i][$l];
			}
		}
		$this->image = $d;
	}

	/**
	 * @param Tile[][] $image
	 */
	private function createFlatImage(array $image, bool $removeBorders)
	{
		$this->hasBorders = !$removeBorders;

		$flat = [];
		$tileDataSize = 10;
		$line = 0;
		foreach($image as $imageRow)
		{
			for($tileDataRow = 0; $tileDataRow < $tileDataSize; $tileDataRow++)
			{
				if(!$removeBorders || ($tileDataRow > 0 && $tileDataRow < $tileDataSize - 1))
				{
					$flat[$line] = '';
					foreach($imageRow as $tile)
					{
						$flat[$line] .= $removeBorders ? substr($tile->data[$tileDataRow], 1, $tileDataSize - 2) : $tile->data[$tileDataRow]; 
					}
					$line++;
				}
			}
		}

		return $flat;
	}

	public function print(bool $die)
	{
		if($this->hasBorders)
		{
			$this->printWithBorders($die);
		}
		else
		{
			$this->printWithoutBorders($die);
		}
	}

	//for debugging only
	public function printWithoutBorders(bool $die)
	{
		echo '<p style="font-family: \'Source Code Pro\', monospace; font-size:14px;"><br>';
		$l = strlen($this->image[0]);
		foreach($this->image as $line)
		{
			$line = str_replace('O', '<b style="color: red;">O</b>', $line);
			echo "$line<br>";
		}
		echo '</p>';
	}

	//for debugging only
	public function printWithBorders(bool $die)
	{
		echo '<p style="font-family: \'Source Code Pro\', monospace; font-size:14px;"><br>';
		$l = strlen($this->image[0]);
		foreach($this->image as $id => $line)
		{
			if($id % 10 === 0)
			{
				echo '<b style="color: red;">'.$line.'</b><br>';
			}
			else
			{
				for($i = 0; $i < $l; $i++)
				{
					$v = $line[$i];
					echo ($i % 10 === 0) ? '<b style="color: red;">'.$v.'</b>' : $v;
				}
				echo '<br>';
			}
		}
		echo '</p>';
	}
}

